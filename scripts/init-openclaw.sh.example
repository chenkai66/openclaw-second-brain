#!/bin/bash

# OpenClaw åˆå§‹åŒ–å’Œé…ç½®è„šæœ¬
# é…ç½® OpenClaw ä½¿ç”¨ Idealab ä»£ç†ï¼ˆç«¯å£ 8080ï¼‰
#
# ä½¿ç”¨æ–¹æ³•ï¼š
# 1. å¤åˆ¶æ­¤æ–‡ä»¶ä¸º init-openclaw.sh
# 2. æ›¿æ¢ä¸‹é¢çš„ API Key ä¸ºçœŸå®žå€¼
# 3. è¿è¡Œ: bash scripts/init-openclaw.sh

echo "ðŸ¦ž æ­£åœ¨åˆå§‹åŒ– OpenClaw é…ç½®..."
echo ""

# åˆ›å»ºé…ç½®ç›®å½•ç»“æž„
mkdir -p ~/.openclaw/agents/main/agent
mkdir -p ~/.openclaw/agents/main/sessions

# åˆ›å»º openclaw.jsonï¼ˆä½¿ç”¨æ­£ç¡®çš„ models.providers é…ç½®ï¼‰
echo "ðŸ“ åˆ›å»º openclaw.json..."
cat > ~/.openclaw/openclaw.json <<'EOF'
{
  "meta": {
    "lastTouchedVersion": "2026.2.26",
    "lastTouchedAt": "2026-02-27T07:30:00.000Z"
  },
  "models": {
    "providers": {
      "anthropic": {
        "baseUrl": "http://127.0.0.1:8080/idealab",
        "apiKey": "YOUR_IDEALAB_API_KEY_HERE",
        "api": "anthropic-messages",
        "models": [
          {
            "id": "claude_sonnet4_5",
            "name": "Claude Sonnet 4.5",
            "reasoning": false,
            "input": ["text", "image"],
            "cost": {
              "input": 0,
              "output": 0,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 200000,
            "maxTokens": 8192
          },
          {
            "id": "claude-opus-4-6",
            "name": "Claude Opus 4.6",
            "reasoning": false,
            "input": ["text", "image"],
            "cost": {
              "input": 0,
              "output": 0,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 200000,
            "maxTokens": 8192
          },
          {
            "id": "claude-haiku-4-5",
            "name": "Claude Haiku 4.5",
            "reasoning": false,
            "input": ["text", "image"],
            "cost": {
              "input": 0,
              "output": 0,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 200000,
            "maxTokens": 8192
          }
        ]
      },
      "bailian": {
        "baseUrl": "https://dashscope.aliyuncs.com/compatible-mode/v1",
        "apiKey": "YOUR_BAILIAN_API_KEY_HERE",
        "api": "openai-completions",
        "models": [
          {
            "id": "qwen-max",
            "name": "Qwen Max",
            "reasoning": false,
            "input": ["text"],
            "cost": {
              "input": 0,
              "output": 0,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 200000,
            "maxTokens": 8192
          }
        ]
      }
    }
  },
  "agents": {
    "defaults": {
      "model": {
        "primary": "anthropic/claude_sonnet4_5"
      },
      "models": {
        "anthropic/claude_sonnet4_5": {},
        "anthropic/claude-opus-4-6": {},
        "anthropic/claude-haiku-4-5": {},
        "bailian/qwen-max": {}
      }
    }
  },
  "commands": {
    "native": "auto",
    "nativeSkills": "auto",
    "restart": true,
    "ownerDisplay": "raw"
  },
  "gateway": {
    "mode": "local",
    "auth": {
      "mode": "token"
    }
  }
}
EOF

echo "âœ… é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆ"
echo ""
echo "âš ï¸  æ³¨æ„: è¯·ç¼–è¾‘ ~/.openclaw/openclaw.json å¹¶æ›¿æ¢å ä½ç¬¦ API Keysï¼š"
echo "  - YOUR_IDEALAB_API_KEY_HERE"
echo "  - YOUR_BAILIAN_API_KEY_HERE"
echo ""
echo "ðŸ“Š é…ç½®æ‘˜è¦:"
echo "  - Provider: Anthropic (Idealab)"
echo "  - Proxy: http://127.0.0.1:8080/idealab"
echo "  - Model: claude_sonnet4_5"
echo "  - API: anthropic-messages"
echo ""
echo "ðŸš€ å¯åŠ¨ Gateway: openclaw gateway install"
echo "ðŸ§ª æµ‹è¯•è¿žæŽ¥: openclaw agent --agent main -m 'æµ‹è¯•'"
